<!DOCTYPE html>
<html>
<head>
  <title>Spotify Web Playback SDK Quick Start Tutorial</title>
</head>
<body>
  <h1>Spotify Web Playback SDK Quick Start Tutorial</h1>
  <h2>Open your console log: <code>View > Developer > JavaScript Console</code></h2>

  <script src="https://sdk.scdn.co/spotify-player.js"></script>
  <script type="text/javascript">
  window.onSpotifyWebPlaybackSDKReady = () => {
    console.log("In onSpotify...");
    document.addEventListener('astilectron-ready', function() {
      console.log("In elec ready");
      astilectron.onMessage(function(message) {
        console.log("In elec onMessage");
        console.log(message);
        const token = message;
        const player = new Spotify.Player({
          name: 'kookBOX',
          getOAuthToken: cb => { cb(token); }
        });

        // Error handling
        player.on('initialization_error', e => { console.error(e); });
        player.on('authentication_error', e => { console.error(e); });
        player.on('account_error', e => { console.error(e); });
        player.on('playback_error', e => { console.error(e); });

        // Playback status updates
        player.on('player_state_changed', state => { console.log(state); });

        // Ready
        player.on('ready', data => {
          let { device_id } = data;
          window.alert('Ready with Device ID ' + device_id);
          astilectron.sendMessage("ready");
        });

        // Connect to the player!
        player.connect();
      });
    });  
  };
  </script>
</body>
</html>